"use strict";function updateBackground(e){var o=angular.element($("#bg")).scope();_.defer(function(){o.$apply(function(){console.log(o),o.bg=e})})}!function(){angular.module("pchk-layout",["pchk-core"]).config(["$stateProvider",function(e){e.state("layout",{templateUrl:"app/components/layout/layout.html"}).state("main",{parent:"layout","abstract":!0,views:{header:{templateUrl:"app/components/layout/header/header.html",controller:"HeaderCtrl as header"},footer:{templateUrl:"app/components/layout/footer/footer.html",controller:"FooterCtrl as footer"}}})}])}(),function(){angular.module("pchk-layout").controller("HeaderCtrl",function(){})}(),function(){angular.module("pchk-layout").controller("FooterCtrl",function(){})}(),function(){angular.module("pchk-core",["ngCookies","ngTouch","ngSanitize","restangular","ui.router","ui.bootstrap"])}(),function(){angular.module("pchk-directives",["pchk-core"]).directive("backImg",function(){return function(e,o,a){a.$observe("backImg",function(e){o.css({"background-image":"url("+e+")","background-size":"cover","background-position":"center",opacity:"0.25"})})}})}(),function(){angular.module("pchk-locations",["pchk-core"]).config(["$stateProvider",function(e){e.state("main.locations",{url:"/locations/:woeid",data:{breadcrumb:["main.home"],title:"Pollen d une location"},views:{"content@layout":{templateUrl:"app/locations/locations.html",controller:"LocationsCtrl as locations"}}})}])}(),function(){angular.module("pchk-locations").factory("LocationsService",["Restangular","$http",function(e,o){return{getForecastFromLocation:function(o){return e.one("forecasts",o).get()},getPhotoFromLocation:function(e){return o({method:"GET",url:"https://api.flickr.com/services/rest/",params:{method:"flickr.photos.search",api_key:"b1e323d889060512b7690c8c24cc1de6",tags:["street","architecture","building","skyscraper","urban"].join(","),tags_mode:"any",sort:"interestingness-desc",privacy_filter:1,accuracy:11,safe_search:1,content_type:1,woe_id:e,media:"photos",extras:["url_o","url_l","license"].join(","),license:[1,2,3,4,5,6,7,8,9,10].join(","),format:"json",nojsoncallback:1}})}}}])}(),function(){angular.module("pchk-locations").controller("LocationsCtrl",["$stateParams","LocationsService",function(e,o){var a=this;updateBackground("assets/images/bg02.jpg"),o.getForecastFromLocation(e.woeid).then(function(e){a.pollens=e.periods,a.city=e.location.name,a.woeid=e.woeid,console.log(a.pollens)}),o.getPhotoFromLocation(e.woeid).success(function(e){if(e){var o=a.getRightUrl(e.photos.photo);o&&(updateBackground(o.url_o),a.photo={url:"https://www.flickr.com/photos/"+o.owner+"/"+o.id})}}).error(function(){a.photo={source:"",url:""}}),a.getRightUrl=function(e){for(var o="",a=Math.round(Math.random()*e.length),t=0,l=a;l<e.length&&!(t>e.length);Math.round(Math.random()*e.length)){if(e[l].url_o&&e[l].width_o>e[l].height_o){o=e[l],console.log(o);break}t++}return o},a.classFromLevel=function(e){var o="";switch(e){case"very_low":o="levelVeryLow";break;case"low":o="levelLow";break;case"medium":o="levelMedium";break;case"high":o="levelHigh";break;case"very_high":o="levelVeryHigh";break;default:o="levelDefault"}return console.log(e+"->"+o),o}}])}(),function(){angular.module("pchk-home",["pchk-core","pchk-directives"]).config(["$stateProvider",function(e){e.state("main.home",{url:"/",data:{breadcrumb:[],title:"Pollen Checker"},views:{"content@layout":{templateUrl:"app/home/home.html",controller:"HomeCtrl as home"}}})}])}(),function(){angular.module("pchk-home").controller("HomeCtrl",["Restangular",function(){updateBackground("assets/images/bg01.jpg")}])}(),function(){angular.module("pchk-error",["pchk-core"]).config(["$stateProvider",function(e){e.state("error",{url:"/404",templateUrl:"app/error/404.html"})}])}(),function(){angular.module("pollenChecker",["pchk-core","pchk-layout","pchk-error","pchk-home","pchk-locations"]).config(["$urlRouterProvider","RestangularProvider",function(e,o){e.when("","/"),e.otherwise("/404"),o.setBaseUrl("https://pollencheck.p.mashape.com/api/1/"),o.setDefaultHeaders({"X-Mashape-Key":"W77yjYEEhamshelfriMgjY3fwPSRp1LdNuAjsnSIMy4kcmQ0G3"})}])}(),angular.module("pollenChecker").run(["$templateCache",function(e){e.put("app/error/404.html",'<div id="center-container"><div><h1>404</h1></div><div><a class="btn btn-info" ui-sref="main.home"><i class="fa fa-home"></i> Retour Ã  l\'accueil</a></div></div>'),e.put("app/home/home.html",'<div class="container"><div class="input-group input-group-lg"><span class="input-group-addon" id="sizing-addon1"><span class="glyphicon glyphicon-map-marker"></span></span> <input type="text" ng-model="city" class="form-control" placeholder="Type your city here" aria-describedby="sizing-addon1"></div><a ui-sref="main.locations({woeid : 766273})">Example for Madrid</a></div>'),e.put("app/locations/locations.html",'<div class="container"><h1>{{locations.city}}</h1><div class="row" ng-show="locations.pollens"><div class="col-xs-12 col-sm-6 col-md-3 pollenLevel"><a href="#" class="thumbnail"><img src="assets/images/ragweed.jpg" alt="Ragweed" class="img-circle {{locations.classFromLevel(locations.pollens[0].ragweed.maxLevel)}}"></a><h3>Ragweed</h3></div><div class="col-xs-12 col-sm-6 col-md-3 pollenLevel"><a href="#" class="thumbnail"><img src="assets/images/birch.jpg" alt="Birch" class="img-circle {{locations.classFromLevel(locations.pollens[0].birch.maxLevel)}}"></a><h3>Birch</h3></div><div class="col-xs-12 col-sm-6 col-md-3 pollenLevel"><a href="#" class="thumbnail"><img src="assets/images/grass.jpg" alt="Grass" class="img-circle {{locations.classFromLevel(locations.pollens[0].grass.maxLevel)}}"></a><h3>Grass</h3></div><div class="col-xs-12 col-sm-6 col-md-3 pollenLevel"><a href="#" class="thumbnail"><img src="assets/images/olive.jpg" alt="Olive" class="img-circle {{locations.classFromLevel(locations.pollens[0].olive.maxLevel)}}"></a><h3>Olive</h3></div></div><a ng-show="locations.photo.url" href="{{locations.photo.url}}">Source de l\'image</a></div>'),e.put("app/components/layout/layout.html",'<header class="header" ui-view="header"></header><div class="content"><div class="container" ui-view="content"></div></div><footer ui-view="footer"></footer>'),e.put("app/components/layout/footer/footer.html","<div></div>"),e.put("app/components/layout/header/header.html",'<div role="navigation"><div class="container"><div class="navbar-header"></div></div></div>')}]);